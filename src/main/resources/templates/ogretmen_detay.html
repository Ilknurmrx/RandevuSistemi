<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <title>Ã–ÄŸretmen DetayÄ± - Randevu Sistemi</title>
    <link rel="stylesheet" href="/css/style.css">
</head>

<body>
    <div class="navbar">
        <div class="logo">Ã–ÄŸretmen DetayÄ±</div>
        <a href="/ogrenci" class="btn btn-secondary">Geri DÃ¶n</a>
    </div>

    <div class="container">
        <div class="card" style="max-width: 800px; margin: 0 auto;">
            <div style="display: flex; align-items: center; gap: 20px; margin-bottom: 20px;">
                <div
                    style="width: 100px; height: 100px; background: #eee; border-radius: 50%; display: flex; align-items: center; justify-content: center; overflow: hidden;">
                    <img th:if="${detay.profilFotografiUrl != null}" th:src="${detay.profilFotografiUrl}"
                        style="width: 100%; height: 100%; object-fit: cover;">
                    <span th:unless="${detay.profilFotografiUrl != null}"
                        style="font-size: 2rem; color: #ccc;">ğŸ‘¤</span>
                </div>
                <div>
                    <h2 th:text="${ogretmen.adSoyad}" style="margin: 0; padding: 0;"></h2>
                    <p th:if="${detay.onayli}" style="color: #00b894; font-weight: bold; margin-top: 5px;">âœ” OnaylÄ±
                        EÄŸitmen</p>
                </div>
            </div>

            <div style="margin-bottom: 20px;">
                <p><strong>BranÅŸ:</strong> <span th:text="${detay.brans}" style="color: #666;"></span></p>

                <!-- Availability Calendar -->
                <div style="margin-top: 20px;">
                    <p><strong>MÃ¼saitlik Durumu:</strong></p>
                    <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                        <div th:each="gun, iter : ${ {'Paz', 'Sal', 'Ã‡ar', 'Per', 'Cum', 'Cmt', 'Paz'} }"
                            style="text-align: center;">
                            <span th:text="${gun}"
                                style="font-size: 0.8rem; display: block; margin-bottom: 5px;"></span>
                            <div th:style="${
                                (iter.index == 0 && musaitlik.pazartesi) || 
                                (iter.index == 1 && musaitlik.sali) || 
                                (iter.index == 2 && musaitlik.carsamba) || 
                                (iter.index == 3 && musaitlik.persembe) || 
                                (iter.index == 4 && musaitlik.cuma) || 
                                (iter.index == 5 && musaitlik.cumartesi) || 
                                (iter.index == 6 && musaitlik.pazar) 
                                ? 'width: 30px; height: 30px; background-color: #00b894; border-radius: 5px;' 
                                : 'width: 30px; height: 30px; background-color: #d63031; border-radius: 5px;'
                            }" title="YeÅŸil: MÃ¼sait, KÄ±rmÄ±zÄ±: Dolu"></div>
                        </div>
                    </div>
                </div>

                <!-- Contact Info -->
                <div style="background: #e3f2fd; padding: 15px; border-radius: 8px; margin-top: 20px;">
                    <p style="margin: 0; font-size: 1.1em; color: #0984e3;">
                        <strong>ğŸ“ Ä°letiÅŸim NumarasÄ±:</strong>
                        <span th:text="${ogretmen.telefon}"></span>
                    </p>
                </div>
            </div>

            <form action="/ogrenci/talep-olustur" method="post" style="margin-bottom: 30px;">
                <input type="hidden" name="ogretmenId" th:value="${ogretmen.id}">
                <button type="submit" class="btn" style="width: 100%; padding: 15px; font-size: 1.1rem;"
                    onclick="return confirm('Randevu talebiniz Ã¶ÄŸretmene iletilecek ve telefon numaranÄ±z paylaÅŸÄ±lacaktÄ±r. OnaylÄ±yor musunuz?')">
                    ğŸ“… Randevu Talep Et
                </button>
            </form>

            <h3 style="border-top: 1px solid #eee; padding-top: 20px;">Ã–ÄŸrenci YorumlarÄ±</h3>
            <ul style="list-style: none; padding: 0;">
                <li th:each="yorum : ${yorumlar}" style="border-bottom: 1px solid #f1f1f1; padding: 15px 0;">
                    <div style="color: #fdcb6e; font-size: 1.2rem; margin-bottom: 5px;">
                        <span th:if="${yorum.puan >= 1}">â˜…</span><span th:if="${yorum.puan >= 2}">â˜…</span><span
                            th:if="${yorum.puan >= 3}">â˜…</span><span th:if="${yorum.puan >= 4}">â˜…</span><span
                            th:if="${yorum.puan == 5}">â˜…</span>
                        <span style="color: #2d3436; font-size: 1rem; font-weight: bold; margin-left: 5px;"
                            th:text="${yorum.puan} + '/5'"></span>
                    </div>
                    <div th:text="${yorum.yorum}" style="color: #2d3436;"></div>
                </li>
            </ul>
            <div th:if="${yorumlar.empty}" style="color: #666; font-style: italic;">HenÃ¼z yorum yapÄ±lmamÄ±ÅŸ.</div>

            <div style="margin-top: 40px; text-align: right;">
                <button onclick="sikayetEt()" class="btn btn-danger"
                    style="padding: 5px 15px; font-size: 0.8rem; background: #ff7675;">âš ï¸ KullanÄ±cÄ±yÄ± Åikayet
                    Et</button>
            </div>

            <script th:inline="javascript">
                function sikayetEt() {
                    let konular = ["RahatsÄ±z etti", "Randevuya gelmedi", "Sahte profil", "DiÄŸer"];
                    let secim = prompt("Åikayet nedeninizi giriniz:\n1- RahatsÄ±z etti\n2- Randevuya gelmedi\n3- Sahte profil\n4- DiÄŸer");

                    if (secim) {
                        let konu = "";
                        if (secim == "1") konu = konular[0];
                        else if (secim == "2") konu = konular[1];
                        else if (secim == "3") konu = konular[2];
                        else konu = konular[3];

                        let aciklama = prompt("LÃ¼tfen ÅŸikayet detayÄ±nÄ± kÄ±saca yazÄ±nÄ±z:");
                        if (aciklama) {
                            // POST isteÄŸi gÃ¶nder (Form oluÅŸturup submit etme hilesi)
                            let form = document.createElement('form');
                            form.method = 'POST';
                            form.action = '/ogrenci/sikayet-et';

                            let inputId = document.createElement('input');
                            inputId.type = 'hidden';
                            inputId.name = 'sikayetEdilenId';
                            inputId.value = [[${ ogretmen.id }]]; // Thymeleaf variable

                            let inputKonu = document.createElement('input');
                            inputKonu.type = 'hidden';
                            inputKonu.name = 'konu';
                            inputKonu.value = konu;

                            let inputAciklama = document.createElement('input');
                            inputAciklama.type = 'hidden';
                            inputAciklama.name = 'aciklama';
                            inputAciklama.value = aciklama;

                            form.appendChild(inputId);
                            form.appendChild(inputKonu);
                            form.appendChild(inputAciklama);
                            document.body.appendChild(form);
                            form.submit();
                        }
                    }
                }
            </script>
        </div>
    </div>
</body>

</html>